/*

MaskIt v1.0

jQuery Input masking plugin.
http://spirytoos.blogspot.com.au/

Copyright (c) 2013 Tomasz Egiert

https://github.com/spirytoos/maskit/blob/master/LICENSE.md

Project site: http://tomaszegiert.seowebsolutions.com.au/maskit/index.html
Github site: https://github.com/spirytoos

 */
 if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){"use strict";if(this==null){throw new TypeError}var t=Object(this);var n=t.length>>>0;if(n===0){return-1}var r=0;if(arguments.length>1){r=Number(arguments[1]);if(r!=r){r=0}else if(r!=0&&r!=Infinity&&r!=-Infinity){r=(r>0||-1)*Math.floor(Math.abs(r))}}if(r>=n){return-1}var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++){if(i in t&&t[i]===e){return i}}return-1}}(function(e){e.fn.maskFields=function(t,n){function h(e){var t=e.split("");var n=false;for(i=0;i<t.length;i++){switch(t[i]){case"?":if(n){t[i]="sEpArAtOr";n=false}else{t[i]=null}break;case"*":if(!n)t[i]="[a-zA-Z1-9]";else t[i]="sEpArAtOr";n=false;break;case"d":if(!n)t[i]="[1-9]";else t[i]="sEpArAtOr";n=false;break;case"a":if(!n)t[i]="[a-zA-Z]";else t[i]="sEpArAtOr";n=false;break;case"^":if(n){t[i]="sEpArAtOr";n=false}else{t[i]=null;n=true}break;default:{var s=false;for(var o in r.specialChars){if(t[i]==o){t[i]=r.specialChars[o];s=true;break}}if(!s)t[i]="sEpArAtOr"}}}while(t.indexOf(null)!=-1){t.splice(t.indexOf(null),1)}return t}function p(e){var t=e.split("");var n=false;for(i=0;i<t.length;i++){switch(t[i]){case"?":if(n){t[i]="?";n=false}else{if(s==null)s=i;t[i]=null}break;case"*":if(!n)t[i]=r.placeholderChar;n=false;break;case"d":if(!n)t[i]=r.placeholderChar;n=false;break;case"a":if(!n)t[i]=r.placeholderChar;n=false;break;case"^":if(n){n=false}else{t[i]=null;n=true}break;default:{for(var o in r.specialChars){if(t[i]==o){t[i]=r.placeholderChar;break}}}}}while(t.indexOf(null)!=-1){t.splice(t.indexOf(null),1)}if(s==null)s=t.length;return t.join("")}function d(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length);t=n.text.length}else if(e.selectionStart||e.selectionStart=="0")t=e.selectionStart;return t}function v(e){var t=0,n=0,r,i,s,o,u;if(typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"){t=e.selectionStart;n=e.selectionEnd}else{i=document.selection.createRange();if(i&&i.parentElement()==e){o=e.value.length;r=e.value.replace(/\r\n/g,"\n");s=e.createTextRange();s.moveToBookmark(i.getBookmark());u=e.createTextRange();u.collapse(false);if(s.compareEndPoints("StartToEnd",u)>-1){t=n=o}else{t=-s.moveStart("character",-o);t+=r.slice(0,t).split("\n").length-1;if(s.compareEndPoints("EndToEnd",u)>-1){n=o}else{n=-s.moveEnd("character",-o);n+=r.slice(0,n).split("\n").length-1}}}}selectionStart=t;selectionEnd=n;if(t==n)selectionStart=null}function m(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){tr=e.createTextRange();tr.collapse(true);tr.moveEnd("character",t);tr.moveStart("character",t);tr.select()}}function g(e){var t=0;for(i=e;i<r.pattern.length;i++){var n=new RegExp("sEpArAtOr");if(n.test(r.pattern[e+t]))t++;else break}return e+t>=r.pattern.length?0:t}function y(e){var t=1;for(i=e;i<r.pattern.length;i++){var n=new RegExp("sEpArAtOr");if(n.test(r.pattern[e+t]))t++;else break}return e+t>=r.pattern.length?0:t}function b(e){var t=1;for(i=e;i>0;i--){var n=new RegExp("sEpArAtOr");if(n.test(r.pattern[e-t]))t++;else break}return e-t<0?0:t}function w(t,n,r){o[r]=n;var i=u.split("");for(a=0;a<o.length;a++){if(o[a]!=undefined)i[a]=o[a]}e(t).val(i.join(""))}function E(t){var n=u.split("");var i=0;for(a=0;a<n.length;a++){if(o[a]!=undefined){n[a]=o[a];i=a}if(n[a]==r.placeholderChar){n[a]=""}}n.splice(i+(!i?0:1),n.length-i);e(t).val(n.join(""))}function S(t){var n=u.split("");for(a=0;a<n.length;a++){if(o[a]!=undefined)n[a]=o[a]}e(t).val(n.join(""))}function x(e){for(a=0;a<s;a++){if(r.pattern[a]!="sEpArAtOr"){if(o[a]==undefined)return false}}return true}function T(e,t,n){for(a=t;a<n;a++){if(o[a]!=undefined){o[a]=undefined}}}var r=e.extend({placeholderChar:"_",alwaysDisplayPlaceholder:true},n);var s=null;r.pattern=h(t);var o=[];var u=p(t);var f=0;var l=null;var c=null;this.each(function(){if(r.alwaysDisplayPlaceholder)S(this);else e(this).val("");e(this).bind("focus",function(e){var t=d(this);S(this);m(this,t)});e(this).bind("blur",function(t){if(!x(this)){o=[];if(r.alwaysDisplayPlaceholder)S(this);else{e(this).val("")}}else if(r.alwaysDisplayPlaceholder){S(this)}else if(!r.alwaysDisplayPlaceholder){E(this)}});e(this).bind("mouseup",function(e){v(this)});e(this).bind("keydown",function(e){if(r.onKeyDown!=undefined)if(!r.onKeyDown(e,this))return false;var t=d(this);var n=typeof e.which=="number"?e.which:e.keyCode;if(n==8){if(selectionStart!=null){T(this,selectionStart,selectionEnd);S(this);m(this,selectionStart);selectionStart=null}else{w(this,undefined,t-b(t));m(this,t-b(t))}return false}else if(n==46){if(selectionStart!=null){T(this,selectionStart,selectionEnd);S(this);m(this,selectionStart);selectionStart=null}else{w(this,undefined,t);m(this,t)}return false}else if(n==37){if(e.shiftKey){v(this);if(selectionStart)selectionStart--}else{m(this,t-b(t));return false}}else if(n==39){if(e.shiftKey){v(this);if(selectionEnd<r.pattern.length)selectionEnd++}else{m(this,t+y(t));return false}}});e(this).bind("keypress",function(e){if(e.shiftKey){if(e.keyCode==39||e.keyCode==37)return;else if(e.keyCode==9)return true}else if(e.keyCode==9)return true;var n=d(this);if(n>=r.pattern.length)return false;n=n+g(n);m(this,n);t=r.pattern[n];var i=new RegExp(t);var s=typeof e.which=="number"?e.which:e.keyCode;var o=String.fromCharCode(s);if(!i.test(o))return false;else{w(this,o,n);m(this,n+y(n));if(x(this)){if(r.onCompleted!=undefined)r.onCompleted(e,this)}return false}})});return this}})(jQuery)